// (C) 2016 Aristech GmbH. All rights reserved.
var DDC;!function(a){var b=function(){function a(){this.events=[]}return a.prototype.registerEvent=function(a){this.events[a]=[]},a.prototype.trigger=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(this.events.hasOwnProperty(a))for(var d=0;d<this.events[a].length;++d)this.events[a][d].apply(this,Array.prototype.slice.call(arguments,1))},a.prototype.on=function(a,b){return this.events.hasOwnProperty(a)&&this.events[a].push(b),b},a.prototype.off=function(a,b){function c(a,b){var c=a.indexOf(b);-1!==c?(console.log("Event found"),a.splice(c,1)):console.log("Event not found:",a,b)}this.events.hasOwnProperty(a)&&c(this.events[a],b),console.log("Events after off:",this.events[a])},a}();a.EventDispatcher=b}(DDC||(DDC={}));var DDC;!function(a){var b=function(){function a(a,b){this.x=a,this.y=b}return a}();a.Point=b}(DDC||(DDC={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},DDC;!function(a){var b=[],c=function(c){function d(a){c.call(this),this.container=new createjs.Container,this.registerEvent("startdragging"),this.registerEvent("stopdragging"),this.registerEvent("dragging"),this.registerEvent("overdroppable"),this.registerEvent("outdroppable"),this.registerEvent("hitdroppable"),this.parent=a,this.parent.addChild(this.container)}return __extends(d,c),d.prototype.draggable=function(a){return void 0===a&&(a=!0),a?this.enableDraggable():this.disableDraggable()},d.prototype.droppable=function(a){return void 0===a&&(a=!0),a?this.enableDroppable():this.disableDroppable()},d.prototype.enableDraggable=function(){var b=this,c=new a.Point(0,0),d=null;return this.downEvent=this.container.on("mousedown",function(e){if(!e.target.hasOwnProperty("isDraggable")||0!=e.target.isDraggable){c.x=e.stageX-this.x,c.y=e.stageY-this.y,b.parent.setChildIndex(b.container,b.parent.getNumChildren()-1);var f={draggable:b};f.draggable=b,b.trigger("startdragging",f),b.moveEvent=b.container.on("pressmove",function(e){b.container.x=e.stageX-c.x,b.container.y=e.stageY-c.y;var g=new a.Point(e.stageX,e.stageY);f.droppable=b.getDroppableUnderPoint(g),b.trigger("dragging",f),d!==f.droppable&&(null!==f.droppable?(f.droppable.trigger("overdroppable",f),null===d?d=f.droppable:(d.trigger("outdroppable",f),d=f.droppable)):null!==d&&(d.trigger("outdroppable",f),d=null))}),b.upEvent=b.container.on("pressup",function(c){var d=new a.Point(c.stageX,c.stageY);f.droppable=b.getDroppableUnderPoint(d),b.trigger("stopdragging",f),b.container.off("pressmove",b.moveEvent),b.container.off("pressup",b.moveEvent),null!==f.droppable&&f.droppable.trigger("hitdroppable",f)})}}),this},d.prototype.disableDraggable=function(){return this.container.off("mousedown",this.downEvent),this},d.prototype.enableDroppable=function(){return this.overEvent=this.container.on("mouseover",function(a){}),b.push(this),this},d.prototype.disableDroppable=function(){this.container.off("mouseover",this.overEvent);var a=b.indexOf(this);return a>-1&&b.splice(a,1),this},d.prototype.getDroppableContainerUnderPoint=function(a){for(var b=this.parent.getObjectsUnderPoint(a.x,a.y,2),c=null,d=0;d<b.length;++d)if(!b[d].parent||b[d].parent.id!==this.container.id){var e=c?this.parent.getChildIndex(c):-1,f=this.parent.getChildIndex(b[d].parent);f>e&&(c=b[d].parent)}return c},d.prototype.getDroppableFromContainer=function(a){for(var c=0;c<b.length;++c)if(b[c].container.id===a.id)return b[c];return null},d.prototype.getDroppableUnderPoint=function(a){var b=this.getDroppableContainerUnderPoint(a);return null===b?null:this.getDroppableFromContainer(b)},d}(a.EventDispatcher);a.DragDropContainer=c}(DDC||(DDC={}));
//# sourceMappingURL=ddcontainer.min.js.map